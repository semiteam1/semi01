SELECT USER_NAME, C.CATEGORY_NAME, D.CATEGORY_NAME, E.CATEGORY_NAME
FROM USER_INFO
JOIN CATEGORY_INFO C ON (INTEREST_MOVIE = C.CATEGORY_TYPE)
JOIN CATEGORY_INFO D ON (INTEREST_DISPLAY = D.CATEGORY_TYPE)
JOIN CATEGORY_INFO E ON (INTEREST_SHOW = E.CATEGORY_TYPE);

SELECT PRODUCT_NO, PRODUCT_TITLE, LOCAL_NO
from product
;

-- 로그인 멤버 맹그루 
SELECT
       USER_NO
     , USER_ID
     , USER_PWD
     , USER_NAME
     , USER_BIRTH
     , C.CATEGORY_NAME
     , D.CATEGORY_NAME
     , E.CATEGORY_NAME
     , EMAIL
     , PHONE
     , GRADE_NAME
     , STATUS
  FROM USER_INFO
  JOIN CATEGORY_INFO C ON (INTEREST_MOVIE = C.CATEGORY_TYPE)
  JOIN CATEGORY_INFO D ON (INTEREST_DISPLAY = D.CATEGORY_TYPE)
  JOIN CATEGORY_INFO E ON (INTEREST_SHOW = E.CATEGORY_TYPE)
  JOIN GRADE G USING(GRADE_NO)
 WHERE USER_ID = ?
   AND USER_PWD = ?
   AND STATUS = 'Y'
   
   
;

-- 랭킹
SELECT 
       PRODUCT_NO
     , CATEGORY_NAME
     , PRODUCT_TITLE
     , LOCAL_TITLE
     , PRODUCT_PLACE
     , START_PERIOD
     , END_PERIOD
     , LEVEL_NAME
     , RUN_TIME
     , PRICE
  FROM PRODUCT P
  JOIN CATEGORY_INFO USING(CATEGORY_TYPE)
  JOIN LOCAL_INFO USING (LOCAL_NO)
  JOIN LEVEL_INFO USING (PRODUCT_LEVEL)
 WHERE PRODUCT_NO 
    IN (
       SELECT PRODUCT_NO
         FROM (
       SELECT
              PRODUCT_NO
            , COUNT(USER_NO) AS "좋아요_수"
        FROM PRODUCT_LIKE
       GROUP BY
             PRODUCT_NO
       ORDER BY
             좋아요_수 DESC))
-- AND ROWNUM = 1
;
  
  
  
  
SELECT PRODUCT_NO
  FROM (
        SELECT
               PRODUCT_NO
             , COUNT(USER_NO) AS "좋아요_수"
         FROM
            PRODUCT_LIKE
        GROUP BY
            PRODUCT_NO
        ORDER BY
            좋아요_수 DESC
      );
